from datetime import date
from datetime import datetime

v = {'FY': [2020, 2019, 2018, 2017, 2016, 2015, 2014, 2013, 2012, 2011, 2010], 
     'Per': [datetime(2020, 9, 30, 0, 0), datetime(2019, 9, 30, 0, 0), datetime(2018, 9, 30, 0, 0), datetime(2017, 9, 30, 0, 0), datetime(2016, 9, 30, 0, 0), datetime(2015, 9, 30, 0, 0), datetime(2014, 9, 30, 0, 0), datetime(2013, 9, 30, 0, 0), datetime(2012, 9, 30, 0, 0), datetime(2011, 9, 30, 0, 0), datetime(2010, 9, 30, 0, 0)],
     'Rev': [21846, 22977, 20609, 18358, 15082, 13880, 12702, 11778, 10421, 9188, 8065],
     'Gross': [21846, 22977, 20609, 18358, 15082, 13880, 12702, 11778, 10421, 9188, 8065],
     'R&D': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     'OI': [14081, 15001, 12954, 12144, 7883, 9064, 7697, 7239, 2139, 5456, 4589],
     'Net': [10866, 12080, 10301, 6699, 5991, 6328, 5438, 4980, 2142, 3646, 2966],
     'EPS': [4.89, 5.32, 4.42, 2.8, 2.48, 2.58, 2.15, 1.9, 0.79, 1.29, 1.0],
     'Shares': [2479, 2529, 2586, 2654, 2678, 2724, 3608, 3716, 3856, 4088, 4384],
     'Cash': [16289, 7838, 8162, 9874, 5619, 3518, 1971, 2186, 2074, 2127, 3867],
     'Assets': [37201, 30138, 26473, 25019, 21735, 17050, 15405, 12924, 16912, 11656, 10483],
     'Debt': [21071, 16729, 16630, 16618, 15882, 0, 0, 0, 0, 0, 32],
     'Liabilities': [44709, 37890, 35219, 35217, 31123, 10394, 11156, 9086, 12383, 8323, 8394],
     'SH_Equity': [36210, 34684, 34006, 32760, 32912, 29842, 27413, 26870, 27630, 26437, 25014],
     'FCF': [9704, 12028, 11995, 8501, 5051, 6170, 6652, 2551, 4633, 3519, 2450],
     'Debt_Repayment': [0, 0, 2295, 489, 244, 0, 0, 0, 0, 47, 16],
     'Buybacks': [7924, 8445, 7028, 6742, 7062, 2828, 4027, 5257, 536, 1925, 944],
     'Div_Paid': [2664, 2269, 1918, 1579, 1350, 1177, 1006, 864, 595, 423, 368],
     'SBC': [416, 407, 327, 235, 221, 187, 172, 179, 147, 154, 131],
     'Div': [1.2, 1.0, 0.825, 0.66, 0.56, 0.48, 0.4, 0.33, 0.22, 0.15, 0.125]
     }

msft = {'FY': [2021, 2020, 2019, 2018, 2017, 2016, 2015, 2014, 2013, 2012, 2011],
        'Per': [datetime(2021, 6, 30, 0, 0), datetime(2020, 6, 30, 0, 0), datetime(2019, 6, 30, 0, 0), datetime(2018, 6, 30, 0, 0), datetime(2017, 6, 30, 0, 0), datetime(2016, 6, 30, 0, 0), datetime(2015, 6, 30, 0, 0), datetime(2014, 6, 30, 0, 0), datetime(2013, 6, 30, 0, 0), datetime(2012, 6, 30, 0, 0), datetime(2011, 6, 30, 0, 0)],
        'Rev': [168088, 143015, 125843, 110360, 89950, 85320, 93580, 86833, 77849, 73723, 69943],
        'Gross': [115856, 96937, 82933, 72007, 55689, 52540, 60542, 59899, 57600, 56193, 54366],
        'R&D': [20716, 19269, 16876, 14726, 13037, 11988, 12046, 11381, 10411, 9811, 9043],
        'OI': [69916, 52959, 42959, 35058, 22326, 20182, 18161, 27759, 26764, 21763, 27161],
        'Net': [61271, 44281, 39240, 16571, 21204, 16798, 12193, 22074, 21863, 16978, 23150],
        'EPS': [8.05, 5.76, 5.06, 2.13, 2.71, 2.1, 1.48, 2.63, 2.58, 2.0, 2.69],
        'Shares': [7608, 7683, 7753, 7794, 7832, 8013, 8254, 8399, 8470, 8506, 8593],
        'Cash': [14224, 13576, 11356, 11946, 7663, 6510, 5595, 8669, 3804, 6938, 9610],
        'Assets': [276268, 250922, 236780, 215112, 195858, 172089, 154449, 145276, 124693, 104649, 95379],
        'Debt': [50074, 59578, 66662, 72242, 76073, 40783, 27808, 20645, 12601, 10713, 11921],        
        'Liabilities': [191791, 183007, 184226, 176130, 168692, 121697, 96140, 82600, 63487, 54908, 51621],
        'SH_Equity': [141988, 118304, 102330, 72718, 72394, 71997, 80083, 89784, 78944, 66363, 57083],
        'FCF': [56118, 45234, 38260, 32252, 31378, 24982, 23136, 26746, 24576, 29321, 24639],
        'Debt_Repayment': [3750, 5518, 4000, 10060, 7922, 2796, 1500, 3888, 1346, 0, 814],
        'Buybacks': [25692, 21625, 18401, 9719, 11016, 15301, 13809, 6709, 4429, 3116, 9133],
        'Div_Paid': [16521, 15137, 13811, 12699, 11845, 11006, 9882, 8879, 7455, 6385, 5180],
        'SBC': [6118, 5289, 4652, 3940, 3266, 2668, 2574, 2446, 2406, 2244, 2166],
        'Div': [2.24, 2.04, 1.84, 1.68, 1.56, 1.44, 1.24, 1.12, 0.92, 0.8, 0.64]}

aapl = {'FY': [2020, 2019, 2018, 2017, 2016, 2015, 2014, 2013, 2012, 2011, 2010],
        'Per': [datetime(2020, 9, 26, 0, 0), datetime(2019, 9, 28, 0, 0), datetime(2018, 9, 29, 0, 0), datetime(2017, 9, 30, 0, 0), datetime(2016, 9, 24, 0, 0), datetime(2015, 9, 26, 0, 0), datetime(2014, 9, 27, 0, 0), datetime(2013, 9, 28, 0, 0), datetime(2012, 9, 29, 0, 0), datetime(2011, 9, 24, 0, 0), datetime(2010, 9, 25, 0, 0)],
        'Rev': [274515, 260174, 265595, 229234, 215639, 233715, 182795, 170910, 156508, 108249, 65225],
        'Gross': [104956, 98392, 101839, 88186, 84263, 93626, 70537, 64304, 68662, 43818, 25684],
        'R&D': [18752, 16217, 14236, 11581, 10045, 8067, 6041, 4475, 3381, 2429, 1782],
        'OI': [66288, 63930, 70898, 61344, 60024, 71230, 52503, 48999, 55241, 33790, 18385],
        'Net': [57411, 55256, 59531, 48351, 45687, 53394, 39510, 37037, 41733, 25922, 14013],
        'EPS': [3.28, 2.97, 2.98, 2.3, 2.08, 2.31, 1.61, 1.42, 1.58, 0.99, 0.54],
        'Shares': [17528214, 18595652, 20000436, 21006768, 22001124, 23172276, 24490652, 26086536, 26469940, 26226060, 25891936],
        'Cash': [38016, 48844, 25913, 20289, 20484, 21120, 13844, 14259, 10746, 9815, 11261],
        'Assets': [323888, 338516, 365725, 367304, 313066, 281470, 223081, 201244, 170705, 111939, 74100],
        'Debt': [98667, 91807, 93735, 97207, 75427, 53463, 28987, 16960, 0, 0, 0],
        'Liabilities': [258549, 248028, 258578, 241272, 193437, 171124, 120292, 83451, 57854, 39756, 27392],
        'SH_Equity': [65339, 90488, 107147, 134047, 128249, 119355, 111547, 123549, 118210, 76615, 47791],
        'FCF': [73365, 58896, 64121, 51147, 53090, 70019, 50142, 45501, 42561, 33269, 16590],
        'Debt_Repayment': [12629, 8805, 6500, 5592, 3816, 514, 339, 0, 0, 0, 0],
        'Buybacks': [71478, 66116, 72069, 32345, 29227, 34710, 44270, 22330, -665, -831, -912],
        'Div_Paid': [14081, 14119, 13712, 12769, 12150, 11561, 11126, 10564, 2488, 0, 0],
        'SBC': [6829, 6068, 5340, 4840, 4210, 3586, 2863, 2253, 1740, 1168, 879],
        'Div': [0.795, 0.75, 0.68, 0.6, 0.545, 0.495, 0.455, 0.407, 0.095, '---', '---']}

goog = {'FY': [2020, 2019, 2018, 2017, 2016, 2015],
        'Per': [datetime(2020, 12, 31, 0, 0), datetime(2019, 12, 31, 0, 0), datetime(2018, 12, 31, 0, 0), datetime(2017, 12, 31, 0, 0), datetime(2016, 12, 31, 0, 0), datetime(2015, 12, 31, 0, 0)],
        'Rev': [182527, 161857, 136819, 110855, 90272, 74989],
        'Gross': [97795, 89961, 77270, 65272, 55134, 46825],
        'R&D': [27573, 26018, 21419, 16625, 13948, 12282],
        'OI': [41224, 34231, 26321, 26146, 23716, 19360],
        'Net': [40269, 34343, 30736, 12662, 19478, 16348],
        'EPS': [58.61, 49.16, 43.7, 18.0, 27.85, 22.84],
        'Shares': [687, 699, 703, 703, 699, 716],
        'Cash': [26465, 18498, 16701, 10715, 12918, 16549],
        'Assets': [296996, 253306, 212684, 177856, 147722, 127745],
        'Debt': [13932, 4554, 4012, 3969, 3935, 1995],
        'Liabilities': [97072, 74467, 55164, 44793, 28461, 27130],
        'SH_Equity': [222544, 201442, 177628, 152502, 139036, 120331],
        'FCF': [42843, 30972, 22832, 23907, 25824, 16109],
        'Debt_Repayment': [2100, 585, 6827, 4377, 10148, 13824],
        'Buybacks': [31149, 18396, 9075, 4846, 3693, 1780],
        'Div_Paid': ['---', '---', '---', '---', '---', 47],
        'SBC': [12991, 10794, 9353, 7679, 6703, 5203],
        'Div': ['---', '---', '---', '---', '---', '---']}

hd = {'FY': [2020, 2019, 2018, 2017, 2016, 2015, 2014, 2013, 2012, 2011, 2010],
      'Per': [datetime(2021, 1, 31, 0, 0), datetime(2020, 2, 2, 0, 0), datetime(2019, 2, 3, 0, 0), datetime(2018, 1, 28, 0, 0), datetime(2017, 1, 29, 0, 0), datetime(2016, 1, 31, 0, 0), datetime(2015, 2, 1, 0, 0), datetime(2014, 2, 2, 0, 0), datetime(2013, 2, 3, 0, 0), datetime(2012, 1, 29, 0, 0), datetime(2011, 1, 30, 0, 0)],
      'Rev': [132110, 110225, 108203, 100904, 94595, 88519, 83176, 78812, 74754, 70395, 67997],
      'Gross': [44853, 37572, 37160, 34356, 32313, 30265, 28954, 27390, 25842, 24262, 23304],
      'R&D': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      'OI': [18278, 15843, 15530, 14681, 13427, 11774, 10469, 9166, 7766, 6661, 5839],
      'Net': [12866, 11242, 11121, 8630, 7957, 7009, 6345, 5385, 4535, 3883, 3338],
      'EPS': [11.94, 10.25, 9.73, 7.29, 6.45, 5.46, 4.71, 3.76, 3.0, 2.47, 2.01],
      'Shares': [1078, 1097, 1143, 1184, 1234, 1283, 1346, 1434, 1511, 1570, 1658],
      'Cash': [7895, 2133, 1778, 3595, 2538, 2216, 1723, 1929, 2494, 1987, 545],
      'Assets': [63455, 48982, 41751, 42254, 40873, 40447, 38593, 39229, 39914, 39398, 38938],
      'Debt': [35822, 28670, 26807, 24267, 22349, 20888, 16869, 14691, 9475, 10758, 8707],
      'Liabilities': [67282, 54352, 45881, 43075, 38633, 36233, 30624, 27996, 23307, 22620, 21236],
      'SH_Equity': [3299, -3116, -1878, 1454, 4333, 6316, 9322, 12522, 17777, 17898, 18889],
      'FCF': [16376, 11045, 10596, 10134, 8162, 7870, 6800, 6239, 5663, 5430, 3489],
      'Debt_Repayment': [4113, 2182, 2244, 1534, 3969, 913, 821, 1928, 649, 1608, 1608],
      'Buybacks': [465, 6685, 9727, 7745, 6662, 6772, 6748, 8305, 3200, 3164, 2504],
      'Div_Paid': [6451, 5958, 4704, 4212, 3404, 3031, 2530, 2243, 1743, 1632, 1569],
      'SBC': [310, 251, 282, 273, 267, 244, 225, 228, 218, 215, 214],
      'Div': [6.0, 5.44, 4.12, 3.56, 2.76, 2.36, 1.88, 1.56, 1.16, 1.04, 0.945]}

cost = {'FY': [2020, 2019, 2018, 2017, 2016, 2015, 2014, 2013, 2012, 2011, 2010],
        'Per': [datetime(2020, 8, 30, 0, 0), datetime(2019, 9, 1, 0, 0), datetime(2018, 9, 2, 0, 0), datetime(2017, 9, 3, 0, 0), datetime(2016, 8, 28, 0, 0), datetime(2015, 8, 30, 0, 0), datetime(2014, 8, 31, 0, 0), datetime(2013, 9, 1, 0, 0), datetime(2012, 9, 2, 0, 0), datetime(2011, 8, 28, 0, 0), datetime(2010, 8, 29, 0, 0)],
        'Rev': [166761, 152703, 141576, 129025, 118719, 116199, 112640, 105156, 99137, 88915, 77946],
        'Gross': [21822, 19817, 18424, 17143, 15818, 15134, 14182, 13208, 12314, 11176, 9951],
        'R&D': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        'OI': [5435, 4737, 4480, 4111, 3672, 3624, 3220, 3053, 2759, 2439, 2077],
        'Net': [4002, 3659, 3134, 2679, 2350, 2377, 2058, 2039, 1709, 1462, 1303],
        'EPS': [9.02, 8.26, 7.09, 6.08, 5.33, 5.37, 4.65, 4.63, 3.89, 3.3, 2.92],
        'Shares': [443901, 442923, 441834, 440937, 441263, 442716, 442485, 440512, 439373, 443094, 445970],
        'Cash': [12277, 8384, 6055, 4546, 3379, 4801, 5738, 4644, 3528, 4009, 3214],
        'Assets': [55556, 45400, 40830, 36347, 33163, 33440, 33024, 30283, 27140, 26761, 23815],
        'Debt': [7514, 5124, 6487, 6573, 4061, 4864, 5093, 4998, 1381, 1253, 2141],
        'Liabilities': [36851, 29816, 27727, 25268, 20831, 22597, 20509, 19271, 14622, 14188, 12885],
        'SH_Equity': [18284, 15243, 12799, 10778, 12079, 10617, 12303, 10833, 12361, 12002, 10829],
        'FCF': [6051, 3358, 2805, 4224, 643, 1892, 1991, 1354, 1577, 1908, 1725],
        'Debt_Repayment': [3324, 230, 229, 2331, 1411, 117, 109, 86, 1012, 111, 194],
        'Buybacks': [196, 247, 328, 469, 486, 481, 296, -16, 523, 400, 358],
        'Div_Paid': [1479, 1038, 689, 3904, 746, 2865, 584, 3560, 446, 389, 338],
        'SBC': [619, 595, 544, 514, 459, 394, 327, 285, 241, 207, 190],
        'Div': [2.7, 2.44, 2.14, 8.9, 1.7, 6.51, 1.33, 8.17, 1.03, 0.89, 0.77]}